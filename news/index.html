<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>오렌지Pay 뉴스 | 신용카드·소액결제·사기·민생 최신 소식</title>
  <meta name="description" content="신용카드, 소액결제, 사기, 민생 분야의 최신 뉴스를 한곳에서 빠르게 확인하세요. 요약, 카테고리 분류, 빠른 링크 제공.">
  <link rel="canonical" href="https://pay24.store/news/">
  <meta property="og:title" content="오렌지Pay 뉴스">
  <meta property="og:description" content="신용카드·소액결제·사기·민생 최신 소식 모아보기">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://pay24.store/news/">
  <meta property="og:image" content="https://pay24.store/img/og-image.webp">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" as="style">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">

  <!-- Tailwind (local build) -->
  <link rel="stylesheet" href="../css/tailwind.min.css">

  <!-- Font Awesome -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="manifest" href="/site.webmanifest">

  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"CollectionPage","name":"오렌지Pay 뉴스","url":"https://pay24.store/news/"}
  </script>
</head>
<body class="bg-slate-50 text-slate-700" style="font-family: 'Noto Sans KR','Inter',sans-serif;">
  <!-- Header (match home) -->
  <header id="header" class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-lg">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-20">
        <!-- Logo -->
        <a href="/" class="flex items-center gap-2">
          <i class="fa-solid fa-credit-card text-orange-500 text-3xl"></i>
          <span class="text-3xl font-extrabold text-orange-600 tracking-tight">오렌지Pay</span>
        </a>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center gap-6 font-semibold">
          <a href="/index.html#services" class="text-base text-slate-600 hover:text-orange-500 transition-colors">서비스 안내</a>
          <a href="/index.html#features" class="text-base text-slate-600 hover:text-orange-500 transition-colors">오렌지Pay 특징</a>
          <a href="/search.html" class="text-base text-slate-600 hover:text-orange-500 transition-colors">검색</a>
          <a href="/about.html" class="text-base text-slate-600 hover:text-orange-500 transition-colors">소개</a>
          <a href="/news/" class="text-base text-orange-600 font-bold border-b-2 border-orange-500">뉴스</a>
          <a href="/blog/" class="text-base text-slate-600 hover:text-orange-500 transition-colors">블로그</a>
          <a href="/index.html#faq" class="text-base text-slate-600 hover:text-orange-500 transition-colors">자주묻는질문</a>
          <a href="/contact.html" class="text-base text-slate-600 hover:text-orange-500 transition-colors">고객센터</a>
        </nav>

        <!-- Mobile Menu Button -->
        <div class="md:hidden">
          <button id="mobile-menu-button" class="p-2 rounded-md text-slate-600 hover:bg-slate-100 hover:text-orange-500" aria-label="메뉴 열기">
            <i id="menu-icon" class="fa-solid fa-bars text-2xl"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
      <nav class="flex flex-col p-4 gap-2">
        <a href="/index.html#services" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">서비스 안내</a>
        <a href="/index.html#features" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">오렌지Pay 특징</a>
        <a href="/search.html" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">검색</a>
        <a href="/about.html" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">소개</a>
        <a href="/news/" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-orange-600 bg-orange-50 border border-orange-200">뉴스</a>
        <a href="/blog/" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">블로그</a>
        <a href="/index.html#faq" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">자주묻는질문</a>
        <a href="/contact.html" class="mobile-nav-link block px-4 py-3 rounded-md font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition-colors">고객센터</a>
      </nav>
    </div>
  </header>

  <!-- 속보 티커 (가운데 정렬) -->
  <div id="ticker" class="bg-gradient-to-r from-orange-600 to-orange-500 text-white">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-3 text-sm overflow-hidden ticker-mask flex items-center gap-4">
      <span class="bg-white text-orange-600 px-3 py-1 rounded-full text-sm font-bold animate-pulse">속보</span>
      <div class="flex-1 overflow-hidden">
        <div id="ticker-inner" class="whitespace-nowrap animate-[scroll_40s_linear_infinite] font-semibold"></div>
      </div>
    </div>
  </div>

  <!-- 사이트 쉘: 좌/우 광고 영역 + 가운데 본문 컬럼 (표준 클래스만 사용) -->
  <div class="container mx-auto px-2 sm:px-4 lg:px-6 py-6">
    <div class="grid grid-cols-12 gap-4">
      <!-- 좌측 광고 (나중에 운용) -->
      <aside class="hidden xl:block col-span-2">
        <div class="sticky top-24">
          <div class="h-[600px] rounded-lg border bg-slate-50 text-slate-400 flex items-center justify-center text-sm">광고 영역</div>
        </div>
      </aside>

      <!-- 가운데 본문 -->
      <main id="content" class="col-span-12 xl:col-span-8">
        <!-- 히어로 + 사이드 트렌딩 -->
        <div class="grid lg:grid-cols-3 gap-8">
          <section class="lg:col-span-2" id="hero"></section>
          <aside class="lg:col-span-1">
            <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-6">
              <h2 class="text-xl font-extrabold mb-4 flex items-center gap-2"><span class="text-orange-600">🔥</span> 인기 급상승</h2>
              <ul id="trending" class="space-y-3"></ul>
            </div>
          </aside>
        </div>

        <!-- 보기 옵션 + 카테고리 탭 + 검색 -->
        <section class="mt-10 border-t border-slate-200 pt-6">
          <div class="flex items-center justify-between mb-4">
            <div class="text-sm text-slate-600">이미지 표시</div>
            <label class="inline-flex items-center cursor-pointer select-none">
              <input id="img-toggle" type="checkbox" class="sr-only">
              <span class="w-10 h-6 bg-slate-300 rounded-full relative transition">
                <span class="dot absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition"></span>
              </span>
            </label>
          </div>
          <!-- 검색 바 & 결과 요약 -->
          <div class="mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <div id="result-info" class="text-sm text-slate-600"></div>
            <div class="w-full sm:w-80 relative">
              <input id="search-input" type="search" inputmode="search" aria-label="뉴스 검색" placeholder="키워드로 검색 (예: 수수료, KT, 사기)" class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 pr-9 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500" />
              <button id="search-clear" class="absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 hidden" aria-label="검색어 지우기">✕</button>
              <ul id="search-suggest" class="absolute left-0 right-0 top-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg p-1 text-sm max-h-60 overflow-auto hidden z-10"></ul>
            </div>
          </div>
          <!-- 빠른 상담 키워드 -->
          <div id="quick-keywords" class="mb-5 flex flex-wrap gap-2">
            <button type="button" data-q="비상금 · 수수료 비교" class="px-3 py-1 rounded-full bg-orange-50 text-orange-700 border border-orange-200 hover:bg-orange-100 text-sm">비상금 · 수수료 비교</button>
            <button type="button" data-q="휴대폰 소액결제 · 정보이용료" class="px-3 py-1 rounded-full bg-orange-50 text-orange-700 border border-orange-200 hover:bg-orange-100 text-sm">휴대폰 소액결제 · 정보이용료</button>
            <button type="button" data-q="신용카드 현금화 · 정산 시간" class="px-3 py-1 rounded-full bg-orange-50 text-orange-700 border border-orange-200 hover:bg-orange-100 text-sm">신용카드 현금화 · 정산 시간</button>
          </div>
          <div class="border-b border-gray-200 mb-6">
            <div class="flex flex-wrap gap-1" id="tabs">
              <button data-cat="" class="px-6 py-3 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent">전체</button>
              <button data-cat="신용카드" class="px-6 py-3 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent">신용카드</button>
              <button data-cat="소액결제" class="px-6 py-3 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent">소액결제</button>
              <button data-cat="사기" class="px-6 py-3 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent">사기</button>
              <button data-cat="민생" class="px-6 py-3 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent">민생</button>
            </div>
          </div>
          <div id="grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
          <div class="mt-6 text-center">
            <button id="load-more" class="inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:border-orange-300 hover:text-orange-700 transition hidden">더보기</button>
          </div>
        </section>
      </main>

      <!-- 우측 광고 (나중에 운용) -->
      <aside class="hidden xl:block col-span-2">
        <div class="sticky top-24">
          <div class="h-[600px] rounded-lg border bg-slate-50 text-slate-400 flex items-center justify-center text-sm">광고 영역</div>
        </div>
      </aside>
    </div>
  </div>

  <!-- Footer (match home) -->
  <footer class="bg-slate-900 text-slate-400 mt-16">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10 text-center">
      <div class="mb-4">
        <a href="/about.html" class="text-sm hover:text-white mx-2 transition-colors">소개</a>
        <span class="text-slate-600">|</span>
        <a href="/contact.html" class="text-sm hover:text-white mx-2 transition-colors">고객센터</a>
        <span class="text-slate-600">|</span>
        <a href="/terms.html" class="text-sm hover:text-white mx-2 transition-colors">이용약관</a>
        <span class="text-slate-600">|</span>
        <a href="/privacy.html" class="text-sm hover:text-white mx-2 transition-colors">개인정보처리방침</a>
      </div>
      <p class="text-sm">&copy; <span id="current-year"></span> 오렌지Pay. All Rights Reserved.</p>
      <p class="text-xs mt-2 text-slate-500">
        본 사이트는 합법적인 금융 정보 제공을 목적으로 하며, 불법적인 '카드깡' 등 여신전문금융업법 위반 행위를 중개하거나 권유하지 않습니다. 모든 서비스는 관련 법령 및 약관을 준수하여 안전하게 진행됩니다.
      </p>
    </div>
  </footer>

  <style>
    @keyframes scroll { from { transform: translateX(100%);} to { transform: translateX(-100%);} }
    .line-clamp-2 { display:-webkit-box; -webkit-line-clamp:2; line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
    .line-clamp-3 { display:-webkit-box; -webkit-line-clamp:3; line-clamp:3; -webkit-box-orient:vertical; overflow:hidden; }
    /* 티커 가장자리 그라데이션 마스크 */
    .ticker-mask { 
      -webkit-mask-image: linear-gradient(90deg, rgba(0,0,0,0), #000 8%, #000 92%, rgba(0,0,0,0));
              mask-image: linear-gradient(90deg, rgba(0,0,0,0), #000 8%, #000 92%, rgba(0,0,0,0));
    }
    /* 카드 호버 효과 */
    .news-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .news-card:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
    /* 검색 하이라이트 */
    .hl { background: #fde68a; color: inherit; padding: 0 2px; border-radius: 2px; }
    @media (prefers-color-scheme: dark) {
      /* 다크모드 대비 최적화 */
      #search-input { background:#0f172a; color:#e2e8f0; border-color:#334155; }
      #search-input::placeholder { color:#94a3b8; }
      #search-suggest { background:#0f172a; color:#e2e8f0; border-color:#334155; }
      .hl { background: rgba(234,179,8,0.35); }
      /* 탭 하단 보더, 텍스트 대비 */
      .border-gray-200 { border-color:#334155 !important; }
      #tabs button { color:#cbd5e1; }
      #tabs button:hover { color:#f1f5f9; }
    }
  </style>
  <script>
    // Mobile Menu Toggle (match home)
    (function(){
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      const menuIcon = document.getElementById('menu-icon');
      const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
      if (mobileMenuButton && mobileMenu && menuIcon){
        mobileMenuButton.addEventListener('click', () => {
          const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
          mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
          mobileMenu.classList.toggle('hidden');
          menuIcon.classList.toggle('fa-bars');
          menuIcon.classList.toggle('fa-xmark');
        });
        mobileNavLinks.forEach(link => {
          link.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
            menuIcon.classList.remove('fa-xmark');
            menuIcon.classList.add('fa-bars');
            mobileMenuButton.setAttribute('aria-expanded', 'false');
          });
        });
      }
    })();
    // 헬퍼
    const fmtDate = d => {
      try { return (new Date(d + 'T09:00:00+09:00')).toISOString().slice(0,10); } catch { return d; }
    };
  const debounce = (fn, ms=200) => { let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), ms); }; };
  const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const highlight = (text, q) => {
    if (!q) return text || '';
    const safe = escapeRegExp(q.trim());
    if (!safe) return text || '';
    try { return (text||'').replace(new RegExp(safe, 'ig'), m=>`<mark class="hl">${m}</mark>`); } catch { return text||''; }
  };
  const badge = (cat) => {
    const colors = {
      '신용카드': 'bg-blue-100 text-blue-700 border-blue-200',
      '소액결제': 'bg-green-100 text-green-700 border-green-200',
      '사기': 'bg-red-100 text-red-700 border-red-200',
      '민생': 'bg-purple-100 text-purple-700 border-purple-200'
    };
    const colorClass = colors[cat] || 'bg-orange-100 text-orange-700 border-orange-200';
    return `<span class="inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-full ${colorClass} border">${cat||'뉴스'}</span>`;
  };
  const getSource = (p) => (Array.isArray(p.tags) && p.tags.length>1) ? String(p.tags[1]).trim() : '';
    const getThumb = (p) => p.aiImage || p.ogImage || p.image || '';
  let imagesEnabled = false;
  const state = { cat: '', q: '', limit: 12 };
  let ALL_POSTS = [];
  const RECENT_KEY = 'newsRecentSearches';
  const loadRecents = () => { try { return JSON.parse(localStorage.getItem(RECENT_KEY) || '[]'); } catch { return []; } };
  const saveRecent = (q) => {
    const v = (q||'').trim(); if (!v) return;
    const arr = loadRecents().filter(x=>x.toLowerCase()!==v.toLowerCase());
    arr.unshift(v); if (arr.length>10) arr.length = 10;
    localStorage.setItem(RECENT_KEY, JSON.stringify(arr));
  };

    async function loadPosts(){
      const res = await fetch('/posts.json', { cache: 'no-store' });
      const all = await res.json();
      // 뉴스만: 블로그 가이드 제외
      return all.filter(p => p.category && p.category !== '블로그');
    }

    function renderHero(post){
      if (!post) return;
      const source = getSource(post);
      const thumb = getThumb(post);
      // 이미지가 있을 때: 오버레이 히어로
      const html = (imagesEnabled && thumb) ? `
        <a href="/${post.url}" class="group block relative overflow-hidden rounded-2xl">
          <div class="relative aspect-[16/9]">
            <img src="${thumb}" alt="" class="w-full h-full object-cover"/>
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
          </div>
          <div class="absolute bottom-0 left-0 right-0 p-6 md:p-7 text-white">
            <span class="inline-block bg-orange-600 px-3 py-1 rounded-full text-xs md:text-sm mb-3">주요뉴스</span>
            <h1 class="text-2xl md:text-3xl font-extrabold mb-2 group-hover:underline">${highlight(post.title, state.q)}</h1>
            <p class="hidden md:block text-lg opacity-90 line-clamp-2">${highlight(post.description||'', state.q)}</p>
            <div class="flex items-center gap-4 mt-4 text-xs md:text-sm opacity-90">
              <time>${fmtDate(post.date)}</time>
              ${source?`<span>${source}</span>`:''}
            </div>
          </div>
        </a>` : `
        <a href="/${post.url}" class="block rounded-2xl border bg-white shadow-xl hover:shadow-2xl transition overflow-hidden">
          <div class="p-6 md:p-7">
            <div class="flex items-center gap-3 mb-2">${badge(post.category)}<time class="text-xs text-slate-500">${fmtDate(post.date)}</time>${source?`<span class=\"text-xs text-slate-500\">· ${source}</span>`:''}</div>
            <h1 class="text-2xl md:text-3xl font-extrabold text-slate-900 leading-tight line-clamp-2 mb-2">${highlight(post.title, state.q)}</h1>
            <p class="text-slate-600 line-clamp-3">${highlight(post.description||'', state.q)}</p>
          </div>
        </a>`;
      document.getElementById('hero').innerHTML = html;
    }

    function renderTrending(posts){
      const ul = document.getElementById('trending');
      ul.innerHTML = posts.slice(0,6).map((p,i)=>{ const src=getSource(p); return `
        <li class="py-2 border-b border-slate-200">
          <a class="group block" href="/${p.url}">
            <div class="flex items-center gap-2 text-xs text-slate-500"><span class="inline-flex w-5 h-5 items-center justify-center text-[11px] font-bold rounded bg-orange-50 text-orange-600">${i+1}</span>${badge(p.category)}<time>${fmtDate(p.date)}</time>${src?`<span>· ${src}</span>`:''}</div>
            <div class="font-semibold group-hover:text-orange-600 line-clamp-2">${p.title}</div>
          </a>
        </li>`; }).join('');
    }

    function renderGrid(posts){
      const grid = document.getElementById('grid');
      grid.innerHTML = posts.map((p,idx)=>{
        const src = getSource(p);
        const thumb = getThumb(p);
        const isLarge = idx < 3;
        return `<a href="/${p.url}" class="news-card block rounded-2xl border border-gray-100 bg-white shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden group">
          ${imagesEnabled && thumb ? `
            <div class="relative overflow-hidden ${isLarge ? 'h-48' : 'h-40'}">
              <img src="${thumb}" alt="" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" loading="lazy" decoding="async"/>
              <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
            </div>`:''}
          <div class="p-5">
            <div class="flex items-center gap-2 mb-1 text-xs text-slate-500">${badge(p.category)}<time>${fmtDate(p.date)}</time>${src?`<span>· ${src}</span>`:''}</div>
            <h3 class="font-bold text-slate-900 group-hover:text-orange-600 transition-colors line-clamp-2 ${isLarge ? 'text-lg' : ''}">${highlight(p.title, state.q)}</h3>
            ${isLarge ? `<p class="text-sm text-slate-600 line-clamp-2 mt-2">${highlight(p.description||'', state.q)}</p>` : ''}
          </div>
        </a>`;
      }).join('');
    }

    function initTabs(all){
      const tabs = document.querySelectorAll('#tabs [data-cat]');
      const updateTabsActive = () => {
        tabs.forEach(b=>{
          const on = b.dataset.cat === state.cat;
          b.classList.toggle('border-orange-600', on);
          b.classList.toggle('text-orange-600', on);
          b.classList.toggle('font-semibold', on);
        });
      };
      const applyFilters = () => {
        // 카테고리 + 검색어 동시 적용
        const q = state.q.trim().toLowerCase();
        let list = state.cat ? all.filter(p=>p.category===state.cat) : all;
        if (q) {
          list = list.filter(p=>{
            const src = (p.title||'') + ' ' + (p.description||'') + ' ' + (getSource(p)||'') + ' ' + (p.category||'');
            return src.toLowerCase().includes(q);
          });
        }
        ALL_POSTS = all;
        // 결과 수 표시
        const info = document.getElementById('result-info');
        if (info) {
          const parts = [];
          if (state.cat) parts.push(`카테고리: ${state.cat}`);
          if (state.q) parts.push(`검색어: "${state.q}"`);
          info.textContent = `검색 결과 ${list.length}건` + (parts.length? ` · ${parts.join(' · ')}` : '');
        }
        // 페이지네이션 처리
        const moreBtn = document.getElementById('load-more');
        const page = list.slice(0, state.limit);
        renderGrid(page);
        if (moreBtn){
          const hasMore = list.length > state.limit;
          moreBtn.classList.toggle('hidden', !hasMore);
          moreBtn.disabled = !hasMore;
        }
        // 트렌딩은 카테고리만 동기화 (검색어는 제외)
        const trendingBase = state.cat ? all.filter(p=>p.category===state.cat) : all;
        renderTrending(trendingBase.slice(1,10));
        updateTabsActive();
        // URL 파라미터 업데이트
        const params = new URLSearchParams(location.search);
        state.cat ? params.set('cat', state.cat) : params.delete('cat');
        state.q ? params.set('q', state.q) : params.delete('q');
        const qs = params.toString();
        history.replaceState(null, '', qs ? `?${qs}` : location.pathname);
      };

      tabs.forEach(b=> b.addEventListener('click', ()=>{ state.cat = b.dataset.cat || ''; applyFilters(); }));

      // 더보기 버튼
      const moreBtn = document.getElementById('load-more');
      if (moreBtn){
        moreBtn.addEventListener('click', ()=>{ state.limit += 12; applyFilters(); });
      }

      // 초기 URL 파라미터 반영
      const params = new URLSearchParams(location.search);
      state.cat = params.get('cat') || '';
      state.q = params.get('q') || '';
      const si = document.getElementById('search-input');
      const sc = document.getElementById('search-clear');
      if (si) {
        si.value = state.q;
        si.addEventListener('input', debounce(()=>{ state.q = si.value; if (sc) sc.classList.toggle('hidden', !state.q); renderSuggestions(); applyFilters(); }, 200));
        si.addEventListener('keydown', (e)=>{ if (e.key==='Enter'){ saveRecent(si.value); renderSuggestions(true); }});
        si.addEventListener('focus', ()=>{ renderSuggestions(); });
        si.addEventListener('blur', ()=>{ setTimeout(()=>{ const ul=document.getElementById('search-suggest'); if(ul) ul.classList.add('hidden'); }, 150); });
      }
      if (sc) {
        sc.classList.toggle('hidden', !state.q);
        sc.addEventListener('click', ()=>{ state.q=''; if (si){ si.value=''; } sc.classList.add('hidden'); renderSuggestions(true); applyFilters(); });
      }

      function renderSuggestions(hide){
        const ul = document.getElementById('search-suggest');
        const si = document.getElementById('search-input');
        if (!ul || !si) return;
        if (hide){ ul.classList.add('hidden'); return; }
        const q = (si.value||'').trim().toLowerCase();
        const items = loadRecents().filter(v=>!q || v.toLowerCase().includes(q)).slice(0,5);
        if (!items.length){ ul.classList.add('hidden'); return; }
        ul.innerHTML = items.map(v=>`<li><button type="button" class="w-full text-left px-3 py-2 rounded hover:bg-orange-50" data-q="${v}">${v}</button></li>`).join('');
        ul.classList.remove('hidden');
        ul.querySelectorAll('button[data-q]').forEach(btn=>{
          btn.addEventListener('click', ()=>{ const val = btn.getAttribute('data-q')||''; if (si){ si.value = val; } state.q = val; saveRecent(val); renderSuggestions(true); applyFilters(); });
        });
      }

      // 외부 재호출용 노출
      window._applyFilters = applyFilters;
      applyFilters();
    }

    function initTicker(all){
      const top5 = all.slice(0,8);
      const inner = document.getElementById('ticker-inner');
      inner.innerHTML = top5.map(p=>`<a class=\"mx-6 hover:underline\" href=\"/${p.url}\">${p.title}</a>`).join('');
    }

    function showSkeleton(){
      const hero = document.getElementById('hero');
      if (hero){
        hero.innerHTML = `
          <div class="animate-pulse">
            <div class="h-64 bg-gray-200 rounded-2xl mb-4"></div>
            <div class="space-y-3">
              <div class="h-4 bg-gray-200 rounded w-3/4"></div>
              <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
          </div>`;
      }
      const grid = document.getElementById('grid');
      if (grid){
        grid.innerHTML = Array.from({length:6}).map(()=>`
          <div class="animate-pulse bg-white rounded-2xl border border-gray-100 p-5 h-48"></div>
        `).join('');
      }
      const trending = document.getElementById('trending');
      if (trending){
        trending.innerHTML = Array.from({length:6}).map(()=>`
          <div class=\"animate-pulse h-6 bg-gray-200 rounded\"></div>
        `).join('');
      }
    }

    (async function(){
      showSkeleton();
      const news = await loadPosts();
      renderHero(news[0]);
      renderTrending(news.slice(1,10));
      initTabs(news);
      initTicker(news);
  const yearSpan = document.getElementById('current-year'); if (yearSpan) yearSpan.textContent = new Date().getFullYear();

      // 이미지 표시 토글 상태
      const key = 'newsImagesEnabled';
      const saved = localStorage.getItem(key);
      // 기본값: ON (이미지 표시). 사용자가 끈 경우에만 '0'으로 저장됨.
      imagesEnabled = (saved === null) ? true : (saved === '1');
      const toggle = document.getElementById('img-toggle');
      if (toggle) {
        toggle.checked = imagesEnabled;
        const knob = toggle.nextElementSibling?.querySelector('.dot');
        const applyKnob = () => {
          const track = toggle.nextElementSibling;
          if (!track || !knob) return;
          track.classList.toggle('bg-orange-500', imagesEnabled);
          track.classList.toggle('bg-slate-300', !imagesEnabled);
          knob.style.transform = imagesEnabled ? 'translateX(1rem)' : 'translateX(0)';
        };
        applyKnob();
        toggle.addEventListener('change', ()=>{
          imagesEnabled = toggle.checked;
          localStorage.setItem(key, imagesEnabled ? '1' : '0');
          // 히어로 및 현재 필터 기반으로 재렌더
          renderHero(news[0]);
          if (typeof window._applyFilters === 'function') window._applyFilters();
          applyKnob();
        });
      }

      // 빠른 키워드 클릭 시: 검색어 적용 후 연락처로 이동
      const quick = document.getElementById('quick-keywords');
      if (quick){
        quick.addEventListener('click', (e)=>{
          const btn = e.target.closest('button[data-q]');
          if (!btn) return;
          const val = btn.getAttribute('data-q') || '';
          const si = document.getElementById('search-input');
          if (si) si.value = val;
          state.q = val;
          try { if (typeof saveRecent === 'function') saveRecent(val); } catch {}
          if (typeof window._applyFilters === 'function') window._applyFilters();
          // 연락처 섹션으로 이동
          window.location.href = 'https://pay24.store/#contact';
        });
      }
    })();
  </script>
</body>
</html>
